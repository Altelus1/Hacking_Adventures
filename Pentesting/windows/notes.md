# Notes in Windows Infrastructure Enumeration and Local Privilege Escalation

## Infrastructure Enumeration:

### Nmap
- ``` nmap -sV -sC (-sS) -p 1-10000 -v ``` [First 10000 ports with default scripts and service versions. Optional for SYN Stealth Scan]
- ``` nmap -p- -v -A -T4 ``` [Full port Agressive scan and OS detection]

### Port 21 -  FTP

- cmd: ``` ftp <ip-address> ```
- Check for anonymous logins

### Port 53 - DNS
- Check domain names of the server nslookup
  - ```bash
	nslookup 
	> server <target ip machine>
	...
	> <target ip machine> -> this should give other domain names
	...
	> <domain name> -> this should give additional info about the domain
    ```
- Check for more info about domain using ``` dig ``` command -> I don't know this yet

### Port 80 - HTTP
- Web Enumeration
 ...

### Port 88 - Kerberos
- Kerberos username enumeration
  - ``` nmap -p 88 --script=krb5-enum-users --script-args krb5-enum-users.realm=<domain>' userdb=/path/to/usernames.txt <target ip> ```
  
 
### Port 445 / SMB (windows)
- To check if we can see Sharenames:
  ``` smbclient -L <ip-address> ```
- To login with username, password, and sharename
  ``` smbclient '\\<ip-address>\<sharename>' --user=<username> -p ```
- To mount to local directory the smb share
  ``` mount -t cifs -o username=<username> //<ip-address>/<sharename> <to mount directory>```
- To unmount
  ``` umount -a -t cifs -o ```
- To recursive list of shares:
  - go to Kali: /usr/share/doc/python3-impacket/examples/smbmap.py
  - command:
	```bash
	  python3 smbmap.py <domain/username> -H <ip-address>
	```

### Enum4linux
- No creds : ``` enum4linux -a <target ip> ```
- With creds: ``` enum4linux -u <username> -p <password> -a <target ip> ```
 

### GetADusers.py
### GetNPUsers.py
- Check for a certain user if kerberos preauth is not required:
	```
	python3 GetNPUsers.py <domain/user> <target ip>
	```

### secretsdump.py
- If a user can dump SAM:
	```
	python3 secretsdump.py <domain/user> <target ip>
	```




## TO TRIES:

### Mimikatz
- Try mo lang haha - post exploitation tool

### References
* https://medium.com/@Shorty420/enumerating-ad-98e0821c4c78




